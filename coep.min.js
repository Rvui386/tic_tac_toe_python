// mini-coi (C) 2023-present SheetJS LLC -- https://sheetjs.com
(function(){if(typeof window==="undefined")return;if(window.crossOriginIsolated)return;const coop="Cross-Origin-Opener-Policy";const coep="Cross-Origin-Embedder-Policy";const w=window;if(w.origin==="null"||w.location.protocol==="file:")return;const h=document.head||document.documentElement;function f(src,type){const s=document.createElement("script");s.src=src;s.type=type;h.insertBefore(s,h.firstChild)}const rh=(v)=>{if(typeof w.chrome!=="undefined"&&typeof navigator!=="undefined"&&navigator.userAgent.indexOf("Edg")===-1)return;if(v.type!=="error")return;const u=v.target.url;if(u.slice(0,6)!=="blob:"||u.slice(0,5)!=="data:")return;if(!v.message.includes(coop)&&!v.message.includes(coep))return;if(confirm("Cannot use SharedArrayBuffer due to incorrect server setup. Please see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer#security_requirements for more details.\n\nClick OK to reload over a service worker"))navigator.serviceWorker.register("coi-sw.js").then(()=>{console.log("Registered service worker");w.location.reload()}).catch((e)=>console.error("Failed to register service worker",e))};w.addEventListener("error",rh);f("./coi-sw.js","module")}())
